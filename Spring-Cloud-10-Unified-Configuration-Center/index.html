<!DOCTYPE html>
<html lang="en">







<head>
	<meta charset="utf-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<link rel="preconnect" href="//www.googletagmanager.com">
	<link rel="preconnect" href="//zz.bdstatic.com">
	<link rel="preconnect" href="//sp0.baidu.com">
	<link rel="preconnect" href="//www.google-analytics.com">
	<link rel="preconnect" href="//cdn1.lncld.net">
	<link rel="preconnect" href="//unpkg.com">
	<link rel="preconnect" href="//app-router.leancloud.cn">
	<link rel="preconnect" href="//9qpuwspm.api.lncld.net">
	<link rel="preconnect" href="//gravatar.loli.net">

	<title>Spring Cloud 10: Unified Configuration Center | Nick Li</title>

	<meta name="HandheldFriendly" content="True">
	<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
	<meta name="generator" content="hexo">
	<meta name="author" content="Nick Li">
	<meta name="description" content>

	

	

	
	<meta name="theme-color" content="#3c484e">
	<meta name="msapplication-TileColor" content="#3c484e">
	

	

	

	<meta property="og:site_name" content="Nick Li">
	<meta property="og:type" content="article">
	<meta property="og:title" content="Spring Cloud 10: Unified Configuration Center | Nick Li">
	<meta property="og:description" content>
	<meta property="og:url" content="http://nicklee1006.github.io/Spring-Cloud-10-Unified-Configuration-Center/">

	
	<meta property="article:published_time" content="2020-02-22T20:02:00+08:00"> 
	<meta property="article:author" content="Nick Li">
	<meta property="article:published_first" content="Nick Li, /Spring-Cloud-10-Unified-Configuration-Center/">
	

	
	
	<link rel="stylesheet" href="/css/allinonecss.min.css">

	
	<script async src="https://www.googletagmanager.com/gtag/js?id=UA-151447201-1"></script>
	<script>
		window.dataLayer = window.dataLayer || [];
		function gtag(){dataLayer.push(arguments);}
		gtag('js', new Date());
		gtag('config', 'UA-151447201-1');
	</script>
	
	
	
</head>
<body class="post-template">
	<div class="site-wrapper">
		




<header class="site-header post-site-header outer">
    <div class="inner">
        
<nav class="site-nav"> 
    <div class="site-nav-left">
        <ul class="nav">
            <li>
                
                <a href="/" title="Home">HOME</a>
                
            </li>
            
            
            <li>
                <a href="/about" title="ABOUT">ABOUT</a>
            </li>
            
            <li>
                <a href="/archives" title="ARCHIVES">ARCHIVES</a>
            </li>
            
            
        </ul> 
    </div>
    
    <div class="search-button-area">
        <a href="#search" class="search-button">Search ...</a>
    </div>
     
    <div class="site-nav-right">
        
        <a href="#search" class="search-button">Search ...</a>
         
        
<div class="social-links">
    
    
    <a class="social-link" title="github" href="https://github.com/nicklee1006" target="_blank" rel="noopener">
        <svg viewbox="0 0 1049 1024" xmlns="http://www.w3.org/2000/svg"><path d="M524.979332 0C234.676191 0 0 234.676191 0 524.979332c0 232.068678 150.366597 428.501342 358.967656 498.035028 26.075132 5.215026 35.636014-11.299224 35.636014-25.205961 0-12.168395-0.869171-53.888607-0.869171-97.347161-146.020741 31.290159-176.441729-62.580318-176.441729-62.580318-23.467619-60.841976-58.234462-76.487055-58.234463-76.487055-47.804409-32.15933 3.476684-32.15933 3.476685-32.15933 53.019436 3.476684 80.83291 53.888607 80.83291 53.888607 46.935238 79.963739 122.553122 57.365291 152.97411 43.458554 4.345855-33.897672 18.252593-57.365291 33.028501-70.402857-116.468925-12.168395-239.022047-57.365291-239.022047-259.012982 0-57.365291 20.860106-104.300529 53.888607-140.805715-5.215026-13.037566-23.467619-66.926173 5.215027-139.067372 0 0 44.327725-13.906737 144.282399 53.888607 41.720212-11.299224 86.917108-17.383422 131.244833-17.383422s89.524621 6.084198 131.244833 17.383422C756.178839 203.386032 800.506564 217.29277 800.506564 217.29277c28.682646 72.1412 10.430053 126.029806 5.215026 139.067372 33.897672 36.505185 53.888607 83.440424 53.888607 140.805715 0 201.64769-122.553122 245.975415-239.891218 259.012982 19.121764 16.514251 35.636014 47.804409 35.636015 97.347161 0 70.402857-0.869171 126.898978-0.869172 144.282399 0 13.906737 9.560882 30.420988 35.636015 25.205961 208.601059-69.533686 358.967656-265.96635 358.967655-498.035028C1049.958663 234.676191 814.413301 0 524.979332 0z"/></svg>
    </a>
    
    
    
    
    
    
    
    <a class="social-link" title="linkedin" href="https://www.linkedin.com/in/chenzhang-li/" target="_blank" rel="noopener">
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewbox="0 0 24 24"><path d="M19 0h-14c-2.761 0-5 2.239-5 5v14c0 2.761 2.239 5 5 5h14c2.762 0 5-2.239 5-5v-14c0-2.761-2.238-5-5-5zm-11 19h-3v-11h3v11zm-1.5-12.268c-.966 0-1.75-.79-1.75-1.764s.784-1.764 1.75-1.764 1.75.79 1.75 1.764-.783 1.764-1.75 1.764zm13.5 12.268h-3v-5.604c0-3.368-4-3.113-4 0v5.604h-3v-11h3v1.765c1.396-2.586 7-2.777 7 2.476v6.759z"/></svg>
    </a>
    
</div>
    </div>
</nav>
    </div>
</header>


<div id="site-main" class="site-main outer" role="main">
    <div class="inner">
        <header class="post-full-header">
            <div class="post-full-meta">
                <time class="post-full-meta-date" datetime="2020-02-22T10:29:00.000Z">
                    2020-02-22
                </time>
                
                <span class="date-divider">/</span>
                
                <a href="/categories/Spring-Cloud/">Spring Cloud</a>&nbsp;&nbsp;
                
                
            </div>
            <h1 class="post-full-title">Spring Cloud 10: Unified Configuration Center</h1>
        </header>
        <div class="post-full ">
            
            <figure class="post-full-image" style="background-image: url(https://i.loli.net/2020/02/23/g7KH5VB1SO23Yih.jpg)">
            </figure>
            
            <div class="post-full-content">
                <article id="photoswipe" class="markdown-body">
                    <p>In monolithic applications, we often use a configuration file (application (*). Properties (yml)) to manage all the configuration of the application. These profiles are very good at their role in monolithic applications, and they don’t make us feel a headache. However, with the introduction of the microservice framework, the number of microservices will continue to increase in our products. Previously, we focused on the scalability and extensibility of the system, but then the problems of configuration management were exposed. At first, the microservers managed their own configurations. There was no problem in the development stage, but in the production environment management, it will be a headache. If you want to update a configuration on a large scale, you can imagine the difficulties.</p>
<p>To this end, in a distributed system, Spring Cloud provides a Config sub-project. The core of this project is the configuration center, which implements configuration services through one server and multiple clients. We can use a configuration server to centrally manage various environment profiles for all services. The configuration service center uses <code>Git</code> for storage by default, so we can easily deploy and modify it, and we can version control the environment configuration.</p>
<p><code>Spring Cloud Config</code> has features such as centralization, version control, support for dynamic updates, and language independence. Its characteristics includes:</p>
<ul>
<li>Provide server and client support (<code>Spring Cloud Config Server</code> and <code>Spring Cloud Config Client</code>);</li>
<li>Centralized management of application configuration in a distributed environment;</li>
<li>Based on the Spring environment, it achieves seamless integration with Spring applications;</li>
<li>Programs that can be used in any language development;</li>
<li>The default implementation is based on <code>Git</code> repositories (also supports <code>SVN</code>), so that version management can be performed;</li>
</ul>
<p>The structure diagram of <code>Spring Cloud Config</code> is as follows:</p>
<img class="post-img b-lazy" data-img="/Spring-Cloud-10-Unified-Configuration-Center/1.png" data-index="0" data-src="/Spring-Cloud-10-Unified-Configuration-Center/1.png">
<br>
<br>

<p>We can see that <code>Spring Cloud Config</code> has two roles (similar to <code>Eureka</code>): <code>Server</code> and <code>Client</code>. As the server of the configuration center, <code>Spring Cloud Config Server</code> assumes the following functions:</p>
<ul>
<li>Update the <code>Git</code> repository copy when pulling the configuration to ensure that the configuration is up to date;</li>
<li>Support loading configuration from yml, json, properties and other files;</li>
<li>Service discovery can be implemented with <code>Eureke</code>, and configuration push updates can be implemented with <code>Cloud Bus</code> (which I will explain in detail later);</li>
<li>The default configuration store is based on a <code>Git</code> repository (can be switched to <code>SVN</code>), which supports configuration version management.</li>
</ul>
<p>For the<code>Spring Cloud Config Client</code>, it is very convenient. We only need to add which configuration file on the Config Server to the startup configuration file.</p>
<h2 id="Example-project"><a href="#Example-project" class="headerlink" title="Example project"></a>Example project</h2><h3 id="Config-Server"><a href="#Config-Server" class="headerlink" title="Config-Server"></a>Config-Server</h3><h4 id="1-Pom-xml"><a href="#1-Pom-xml" class="headerlink" title="1. Pom.xml"></a>1. Pom.xml</h4><p><code>Config-Server</code> is a standard Spring Boot application</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependencies</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.cloud<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-cloud-config-server<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependencies</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h4 id="2-Main-application"><a href="#2-Main-application" class="headerlink" title="2. Main application"></a>2. Main application</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@SpringBootApplication</span></span><br><span class="line"><span class="meta">@EnableConfigServer</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ConfigServerApplication</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        SpringApplication.run(ConfigServerApplication<span class="class">.<span class="keyword">class</span>, <span class="title">args</span>)</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>Add <code>@EnableConfigServer</code>, others are consistent with previous applications.</p>
<h4 id="3-application-properties"><a href="#3-application-properties" class="headerlink" title="3. application.properties"></a>3. application.properties</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">server.port=8280</span><br><span class="line"></span><br><span class="line">spring.application.name=config-server</span><br><span class="line"></span><br><span class="line">spring.cloud.config.server.git.uri=https://github.com/nicklee1006/SpringCloudDemoSampleConfig</span><br><span class="line">spring.cloud.config.server.git.username=your git username</span><br><span class="line">spring.cloud.config.server.git.password=your git password</span><br></pre></td></tr></table></figure>

<p>The most important thing here is to configure the Git repository address and login username and password.</p>
<h4 id="4-Sample-config-file"><a href="#4-Sample-config-file" class="headerlink" title="4. Sample config file"></a>4. Sample config file</h4><p>We add a sample configuration file to the SpringCloudDemoSampleConfig repository.</p>
<p>sample-service.properties</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">foo = bar</span><br></pre></td></tr></table></figure>

<p>sample-service-dev.properties</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">bar = 12345</span><br></pre></td></tr></table></figure>

<h4 id="5-Test"><a href="#5-Test" class="headerlink" title="5. Test"></a>5. Test</h4><p>Start <code>service-discovery</code> and <code>config-server</code>. In the terminal we enter the following command:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">curl localhost:8280/sample-service/dev</span><br></pre></td></tr></table></figure>

<p>The following will be output in the terminal:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&#123;&quot;name&quot;:&quot;sample-service&quot;,&quot;profiles&quot;:[&quot;dev&quot;],&quot;label&quot;:null,&quot;version&quot;:&quot;17ca16db404875d8b7ab57c9bfce33b45557114f&quot;,&quot;state&quot;:null,&quot;propertySources&quot;:</span><br><span class="line">    [</span><br><span class="line">        &#123;&quot;name&quot;:&quot;https://github.com/nicklee1006/SpringCloudDemoSampleConfig/sample-service-dev.properties&quot;,&quot;source&quot;:&#123;&quot;bar&quot;:&quot;12345&quot;&#125;&#125;,</span><br><span class="line">        &#123;&quot;name&quot;:&quot;https://github.com/nicklee1006/SpringCloudDemoSampleConfig/sample-service.properties&quot;,&quot;source&quot;:&#123;&quot;foo&quot;:&quot;bar&quot;&#125;&#125;</span><br><span class="line">    ]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>Here we can see that the configuration file we submitted to Git can be correctly read by <code>config-server</code>.</p>
<h4 id="config-server-default-configuration"><a href="#config-server-default-configuration" class="headerlink" title="config-server default configuration"></a>config-server default configuration</h4><p>When we look at the source code, we find that there is a default configuration file <code>configserver.yml</code> in the <code>spring-cloud-config-server.jar</code> package, which means that when we set <code>spring.application.name = configserver</code>, the configuration will be loaded by default. The configuration file is as follows:</p>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">info:</span></span><br><span class="line">  <span class="attr">component:</span> <span class="string">Config</span> <span class="string">Server</span></span><br><span class="line"><span class="attr">spring:</span></span><br><span class="line">  <span class="attr">application:</span></span><br><span class="line">    <span class="attr">name:</span> <span class="string">configserver</span></span><br><span class="line">  <span class="attr">jmx:</span></span><br><span class="line">    <span class="attr">default_domain:</span> <span class="string">cloud.config.server</span></span><br><span class="line">  <span class="attr">cloud:</span></span><br><span class="line">    <span class="attr">config:</span></span><br><span class="line">      <span class="attr">server:</span></span><br><span class="line">        <span class="attr">git:</span></span><br><span class="line">          <span class="attr">uri:</span> <span class="string">https://github.com/spring-cloud-samples/config-repo</span></span><br><span class="line">          <span class="attr">repos:</span></span><br><span class="line">            <span class="bullet">-</span> <span class="attr">patterns:</span> <span class="string">multi-repo-demo-*</span></span><br><span class="line">              <span class="attr">uri:</span> <span class="string">https://github.com/spring-cloud-samples/config-repo</span></span><br><span class="line"></span><br><span class="line"><span class="attr">server:</span></span><br><span class="line">  <span class="attr">port:</span> <span class="number">8888</span></span><br><span class="line"><span class="attr">management:</span></span><br><span class="line">  <span class="attr">context_path:</span> <span class="string">/admin</span></span><br></pre></td></tr></table></figure>

<p>Port <code>8888</code> is used by default, and the configuration file is found from the Git repository at h<code>ttps://github.com/spring-cloud-samples/config-repo</code>.</p>
<h3 id="config-client"><a href="#config-client" class="headerlink" title="config-client"></a>config-client</h3><p><code>config-client</code> can be any application based on <code>Spring boot</code>. Here we build a very simple web project.</p>
<h4 id="1-pom-xml"><a href="#1-pom-xml" class="headerlink" title="1. pom.xml"></a>1. pom.xml</h4><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.cloud<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-cloud-starter-config<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-web<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h4 id="2-Main-application-1"><a href="#2-Main-application-1" class="headerlink" title="2. Main application"></a>2. Main application</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@EnableDiscoveryClient</span></span><br><span class="line"><span class="meta">@SpringBootApplication</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ConfigClientApplication</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        SpringApplication.run(ConfigClientApplication<span class="class">.<span class="keyword">class</span>, <span class="title">args</span>)</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="3-Controller"><a href="#3-Controller" class="headerlink" title="3. Controller"></a>3. Controller</h4><p>The main purpose of this controller is to verify that we can get the configuration content from the Git repository.</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@RestController</span></span><br><span class="line"><span class="meta">@RequestMapping</span>(<span class="string">"/cfg"</span>)</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ConfigController</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Value</span>(<span class="string">"$&#123;foo&#125;"</span>)</span><br><span class="line">    String foo;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Value</span>(<span class="string">"$&#123;bar&#125;"</span>)</span><br><span class="line">    String bar;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@RequestMapping</span>(value = <span class="string">"/foo"</span>)</span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">foo</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="keyword">return</span> foo + <span class="string">"——"</span> + bar;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="4-bootstrap-properties"><a href="#4-bootstrap-properties" class="headerlink" title="4. bootstrap.properties"></a>4. bootstrap.properties</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">server.port=8080</span><br><span class="line"></span><br><span class="line">spring.application.name=sample-service</span><br><span class="line">spring.cloud.config.profile=dev</span><br><span class="line">spring.cloud.config.uri= http://localhost:8280/</span><br></pre></td></tr></table></figure>

<p>Defines the name and profile of the microservice and the address of the configuration server.</p>
<blockquote>
<p>Note: These configurations cannot be configured in the <code>application.properties</code> file, because there is a boot context and application context when Spring Boot is started. Only when the configuration server information is defined in the boot context can the configuration information be obtained from the configuration server. Otherwise, when the service starts, it will report an error that the foo variable definition cannot be found.</p>
</blockquote>
<h4 id="5-Test-1"><a href="#5-Test-1" class="headerlink" title="5. Test"></a>5. Test</h4><p>Start <code>config-client</code> and visit: <a href="http://localhost:8080/cfg/foo" target="_blank" rel="noopener">http://localhost:8080/cfg/foo</a>:</p>
<img class="post-img b-lazy" data-img="/Spring-Cloud-10-Unified-Configuration-Center/2.png" data-index="1" data-src="/Spring-Cloud-10-Unified-Configuration-Center/2.png">
<br>
<br>

<p>It indicates that our <code>config-client</code> has successfully obtained the configuration data from the <code>config-server</code>.</p>
<h3 id="Spring-project-configuration-load-order"><a href="#Spring-project-configuration-load-order" class="headerlink" title="Spring project configuration load order"></a>Spring project configuration load order</h3><ul>
<li>Command line arguments</li>
<li><code>SPRING_APPLICATION_JSON</code> parameter</li>
<li>Load JNDI properties from <code>java:comp/env</code></li>
<li>Java system properties (<code>System.getProperties()</code>)</li>
<li>Operating system environment variables</li>
<li>If configured using random.* Properties, use <code>RandomValuePropertySource</code> to generate</li>
<li>External application-specific configuration files, such as <code>application-{profile}.properties</code> or YAML variants</li>
<li>Internal application-specific profile files such as: <code>application-{profile}.properties</code> or YAML variants</li>
<li>External application configuration files, such as <code>application.properties</code> or YAML variants</li>
<li>Internal application configuration files such as: <code>application.properties</code> or YAML variants</li>
<li>Load the configuration file pointed to by <code>@PropertySource</code> or <code>@ConfigurationProperties</code> of the <code>@Configuration</code> class</li>
<li>Default configuration, set by <code>SpringApplication.setDefaultProperties</code></li>
</ul>
<h2 id="Detailed-configuration-rules"><a href="#Detailed-configuration-rules" class="headerlink" title="Detailed configuration rules"></a>Detailed configuration rules</h2><p>Take a look at how <code>config-client</code> obtaining configuration data from <code>config-server</code>:</p>
<ol>
<li>When the <code>config-client</code> starts, it requests the <code>config-server</code> for configuration data according to the application, profile, and label configured in bootstrap.properties;</li>
<li>The <code>config-server</code> searches for a matching configuration file from a Git repository (here Git is taken as an example) according to the request and configuration of the <code>config-client</code>;</li>
<li>The <code>config-server</code> pulls the matched Git repository to local and establishes a local cache;</li>
<li>The <code>config-server</code> creates a Spring <code>ApplicationContext</code> instance, populates the configuration information according to the pulled configuration file, and then returns the configuration information to the <code>config-client</code>;</li>
<li>After the <code>config-client</code> obtains the configuration data returned by the <code>config-server</code>, it loads these configuration data into its own context. At the same time, because the priority of these configuration data is higher than the configuration in the local Jar package, the local configuration will no longer be loaded.</li>
</ol>
<p>So, how does the <code>config-server</code> match the configuration files in the Git repository? Usually, we will create a configuration file similar to the following for a project:</p>
<ul>
<li>service.properties: basic configuration file;</li>
<li>service-dev.properties: configuration file for development;</li>
<li>service-test.properties: configuration file used for testing;</li>
<li>service-prod.properties: configuration file used by the production environment;</li>
</ul>
<p>When we visit the endpoint of <code>config-server</code>, we will match the corresponding configuration file according to the following mapping relationship:</p>
<ol>
<li>/{application}/{profile}[/{label}]</li>
<li>/{application}-{profile}.yml</li>
<li>/{label}/{application}-{profile}.yml</li>
<li>/{application}-{profile}.properties</li>
<li>/{label}/{application}-{profile}.properties</li>
</ol>
<p>The above Url will be mapped to a profile with the format: <code>{application}-{profile}.properties(yml)</code>. In addition, label corresponds to the branch name on Git and is an optional parameter. If not, it is the default master branch.</p>
<p>The <code>bootstrap.properties</code> of <code>config-client</code> corresponds to the following:</p>
<ul>
<li><code>spring.application.name</code> &lt;==&gt; <code>application</code>;</li>
<li><code>spring.cloud.config.profile</code> &lt;==&gt; <code>profile</code>;</li>
<li><code>spring.cloud.config.label</code> &lt;==&gt; <code>label</code>.</li>
</ul>
<h3 id="Git-repository-config"><a href="#Git-repository-config" class="headerlink" title="Git repository config"></a>Git repository config</h3><p>The <code>config-server</code> uses Git by default, so the configuration is very simple, such as the configuration(application.properties) above:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">spring.cloud.config.server.git.uri=http://</span><br><span class="line">spring.cloud.config.server.git.username=username</span><br><span class="line">spring.cloud.config.server.git.password=password</span><br></pre></td></tr></table></figure>

<h4 id="1-Using-placeholders"><a href="#1-Using-placeholders" class="headerlink" title="1. Using placeholders"></a>1. Using placeholders</h4><p>We can also use <code>{application}</code>, <code>{profile}</code> and <code>{label}</code> placeholders in the server configuration, as follows:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">spring.cloud.config.server.git.uri = http://github.com/cd826/&#123;application&#125;</span><br><span class="line">spring.cloud.config.server.git.username = username</span><br><span class="line">spring.cloud.config.server.git.password = password</span><br></pre></td></tr></table></figure>

<p>In this way, we can create a separate repository for each application client.</p>
<p>It should be noted here that if a branch or label in Git contains “/“, you need to use “(_)” instead in the {label} parameter. This is mainly to avoid conflicts with Http URL escape character processing.</p>
<h4 id="2-Use-pattern-matching"><a href="#2-Use-pattern-matching" class="headerlink" title="2. Use pattern matching"></a>2. Use pattern matching</h4><p>We can also use <code>{application}/{profile}</code> for pattern matching in order to get the corresponding profile. An example configuration is as follows:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">spring.cloud.config.server.git.uri = https://github.com/spring-cloud-samples/config-repo</span><br><span class="line"></span><br><span class="line">spring.cloud.config.server.git.repos.simple = https://github.com/simple/config-repo</span><br><span class="line"></span><br><span class="line">spring.cloud.config.server.git.repos.special.pattern = special */dev*, *special*/dev*</span><br><span class="line">spring.cloud.config.server.git.repos.special.uri = https://github.com/special/config-repo</span><br><span class="line"></span><br><span class="line">spring.cloud.config.server.git.repos.local.pattern = local*</span><br><span class="line">spring.cloud.config.server.git.repos.local.uri = file:/home/configsvc/config-repo</span><br></pre></td></tr></table></figure>

<p>If multiple values ​​need to be configured in the pattern, they can be separated by commas.</p>
<p>If <code>{application}/{profile}</code> does not match any resources, the default URI configured by <code>spring.cloud.config.server.git.uri</code> is used.</p>
<p>When we use a yml type file for configuration, if the schema attribute is a YAML array, it can also be defined using a YAML array format. This can be set to multiple configuration files, such as:</p>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">spring:</span></span><br><span class="line">  <span class="attr">cloud:</span></span><br><span class="line">    <span class="attr">config:</span></span><br><span class="line">      <span class="attr">server:</span></span><br><span class="line">        <span class="attr">git:</span></span><br><span class="line">          <span class="attr">uri:</span> <span class="string">https://github.com/spring-cloud-samples/config-repo</span></span><br><span class="line">          <span class="attr">repos:</span></span><br><span class="line">            <span class="attr">development:</span></span><br><span class="line">              <span class="attr">pattern:</span></span><br><span class="line">                <span class="bullet">-</span> <span class="string">*/development</span></span><br><span class="line">                <span class="bullet">-</span> <span class="string">*/staging</span></span><br><span class="line">              <span class="attr">uri:</span> <span class="string">https://github.com/development/config-repo</span></span><br><span class="line">            <span class="attr">staging:</span></span><br><span class="line">              <span class="attr">pattern:</span></span><br><span class="line">                <span class="bullet">-</span> <span class="string">*/qa</span></span><br><span class="line">                <span class="bullet">-</span> <span class="string">*/production</span></span><br><span class="line">              <span class="attr">uri:</span> <span class="string">https://github.com/staging/config-repo</span></span><br></pre></td></tr></table></figure>

<h4 id="3-Search-directory"><a href="#3-Search-directory" class="headerlink" title="3. Search directory"></a>3. Search directory</h4><p>When we store the configuration file in a subdirectory in the Git repository, we can specify the directory by setting <code>search-path</code>. Similarly, <code>search-path</code> also supports the above placeholders. Examples are as follows:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">spring.cloud.config.server.git.uri = https://github.com/spring-cloud-samples/config-repo</span><br><span class="line">spring.cloud.config.server.git.searchPaths = foo, bar*</span><br></pre></td></tr></table></figure>

<p>In this way, the system will automatically search the subdirectories of foo and the subdirectories in the folders starting with bar.</p>
<h4 id="4-SSH-configuration"><a href="#4-SSH-configuration" class="headerlink" title="4. SSH configuration"></a>4. SSH configuration</h4><p>If you do not want to use HTTPS and user authentication, you can also use SSH directly. At this time, we only need to store the keys required by ssh in the <code>~/.ssh</code> directory, and point the configured URI to the SSH address, such as: <code>git@github.com:nicklee1006/SpringCloudDemoSampleConfig</code>.</p>
<p>If you know your <code>~/.git</code> directory clearly, then you can use <code>git config --global</code> to configure it. Otherwise, you can use global configuration, such as: <code>git config --global http.sslVerify false</code>.</p>
<h4 id="5-Proxy"><a href="#5-Proxy" class="headerlink" title="5. Proxy"></a>5. Proxy</h4><p><code>config-server</code> uses JGit to access the configuration repository, so we can configure the proxy used by HTTPS under <code>~/.git/config</code>, or use the JVM system properties <code>-Dhttps.proxyHost</code> and <code>-Dhttps.proxyPort</code> to configure.</p>
<h4 id="6-Local-cache"><a href="#6-Local-cache" class="headerlink" title="6. Local cache"></a>6. Local cache</h4><p>When <code>config-server</code> obtains the configuration information from Git (or SVN), it will store a copy in the local file system. By default, it will be stored in the system temporary directory, and it starts with <code>config-repo-</code>. On Linux systems, the default directory is <code>/tmp/config-repo-&lt;randomid&gt;</code>. <code>config-server</code> storing configuration information locally can effectively prevent the problem that the Git repository fails and cannot be accessed. When <code>config-server</code> cannot access the Git repository, it will read the configuration stored in the local file before, and then The configuration information is returned to <code>config-server</code>.</p>
<p>The official Spring Cloud documentation suggests that we specify a local file path in <code>config-server</code> to avoid unpredictable errors. You can use the following property configuration to specify the local file path:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">## Git</span><br><span class="line">spring.cloud.config.server.git.basedir=tmp/</span><br><span class="line"></span><br><span class="line">## SVN</span><br><span class="line">spring.cloud.config.server.svn.basedir=tmp/</span><br></pre></td></tr></table></figure>

<h3 id="SVN-configuration"><a href="#SVN-configuration" class="headerlink" title="SVN configuration"></a>SVN configuration</h3><p>If using SVN instead of Git, only need to make the following changes in <code>config-server</code> to support SVN repositories.</p>
<h4 id="pom-xml"><a href="#pom-xml" class="headerlink" title="pom.xml"></a>pom.xml</h4><p>Add the following dependencies to the pom file:</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.tmatesoft.svnkit<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>svnkit<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h4 id="appliaction-properties"><a href="#appliaction-properties" class="headerlink" title="appliaction.properties"></a>appliaction.properties</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">spring.cloud.config.server.svn.uri = &#123;your svn server&#125;</span><br><span class="line">spring.cloud.config.server.svn.username = username</span><br><span class="line">spring.cloud.config.server.svn.password = password</span><br></pre></td></tr></table></figure>

<h3 id="File-system"><a href="#File-system" class="headerlink" title="File system"></a>File system</h3><p>If don’t want to use Git or SVN in your <code>config-server</code>, then we can also load the corresponding configuration file directly from the current classpath or file system, just set in the configuration file as follows:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">spring.profiles.active = native</span><br></pre></td></tr></table></figure>

<p>Note that <code>config-server</code> is loaded from the classpath by default. We can use the <code>spring.cloud.config.server.native.searchLocations</code> property to set the directory of the configuration file. For the file path, our configuration must start with <code>file:</code>. If it is a Windows system, we must escape <code>/</code> for the absolute path. For example, under Windows we need to configure the following: <code>file:///${user.home}/config-repo</code>.</p>
<p>In addition, when we use the file system as a configuration file repository, the configuration of <code>spring.cloud.config.server.native.searchLocations</code> also supports <code>{application}</code>, <code>{profile}</code>, and <code>{label}</code> placeholders.</p>
<blockquote>
<p>Spring Cloud officially recommends that you can use the file system during testing and development, but in the formal environment, try to use Git or SVN.</p>
</blockquote>
<blockquote>
<p>In addition, <code>Spring Cloud Config</code> also supports another configuration file method: <code>Vault Server</code>.</p>
</blockquote>
<h2 id="Security"><a href="#Security" class="headerlink" title="Security"></a>Security</h2><h3 id="config-server-access-security"><a href="#config-server-access-security" class="headerlink" title="config-server access security"></a>config-server access security</h3><p>For some of the configuration content that we store in the configuration center, there will always be some sensitive information, such as the user name and password for the database connection. You ca n’t run naked, so we still need to do some security control on <code>config-server</code>. Of course, there are many types of security controls for <code>config-server</code>, such as physical network restrictions, OAuth2 authorization, and so on. However, because we are using SpringBoot here, using <code>Spring Security</code> will be easier and simpler. At this time, we only need to add the following dependencies to <code>config-server</code></p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/ <span class="attr">groupId</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-security<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>When we start <code>config-server</code>, <code>Spring Security</code> will generate an access password for us by default. This method is often not what we need, so generally we need to configure the username and password in the configuration file, such as:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">spring.security.user.name=username</span><br><span class="line">spring.security.user.password=pwd</span><br></pre></td></tr></table></figure>

<p> When we need to access <code>config-server</code>, a user authentication dialog will pop up. At this time, for <code>config-client</code> we need to add user and access password configuration in the configuration file, as follows:</p>
 <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">spring.cloud.config.username=username</span><br><span class="line">spring.cloud.config.password=pwd</span><br></pre></td></tr></table></figure>

<h3 id="Encryption-and-decryption"><a href="#Encryption-and-decryption" class="headerlink" title="Encryption and decryption"></a>Encryption and decryption</h3><p>Access security is the overall control. In most cases, we also need to encrypt the sensitive content and store it, such as the user name and login password for database access. Fortunately, <code>Spring Cloud Config</code> provides us with corresponding support.</p>
<p><code>Spring Cloud Config</code> provides two encryption and decryption methods: </p>
<ul>
<li>symmetric encryption;</li>
<li>asymmetric encryption. </li>
</ul>
<p>Before describing how to use it, let’s look at some prerequisites.</p>
<h4 id="Install-JCE-Java-Cryptography-Extension"><a href="#Install-JCE-Java-Cryptography-Extension" class="headerlink" title="Install JCE (Java Cryptography Extension)"></a>Install JCE (Java Cryptography Extension)</h4><p>The encryption and decryption provided by <code>Spring Cloud Config</code> depends on <code>JCE</code>. </p>
<p>For <code>JDK 9</code> and later, JCE is already included</p>
<p>For earlier releases, we need to install <code>JCE</code> first. The installation method is also relatively simple, that is, download the corresponding Jar packages, and then replace these packages with the files corresponding to <code>$JDK_HOME/jar/lib/security</code>. For JDK8, the download address is: <a href="https://www.oracle.com/java/technologies/javase-jce-all-downloads.html" target="_blank" rel="noopener">JCE</a>.</p>
<h4 id="Encryption-and-decryption-endpoint"><a href="#Encryption-and-decryption-endpoint" class="headerlink" title="Encryption and decryption endpoint"></a>Encryption and decryption endpoint</h4><p>In addition, <code>Spring Cloud Config</code> also provides two endpoints for encryption and decryption, as follows:</p>
<ul>
<li><strong>/encrypt:</strong> Encrypt endpoint, use the format: <code>curl $CONFIG_SERVER/encrypt -d The content to be encrypted</code></li>
<li><strong>/decrypt:</strong> The decryption endpoint, using the format: <code>curl $CONFIG_SERVER/decrypt -d The content to be decrypted</code></li>
</ul>
<blockquote>
<p>Note: When your test contains special characters in encryption and decryption, URL encoding is required. At this time, you need to use <code>--data-urlencode</code> instead of <code>-d</code>.</p>
</blockquote>
<h4 id="Symmetric-encryption"><a href="#Symmetric-encryption" class="headerlink" title="Symmetric encryption"></a>Symmetric encryption</h4><p>The configuration of symmetric encryption and decryption is very simple. We just need to add the key used for encryption and decryption in the configuration file, such as:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">encrypt.key = key</span><br></pre></td></tr></table></figure>

<p>After configuration, you can start <code>config-server</code> and use the endpoint mentioned above for encryption and decryption testing.</p>
<p>For the configuration file, we need to add a <code>{cipher}</code> leader to the encrypted content. Such as:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">spring.datasource.username = dbuser</span><br><span class="line">spring.datasource.password = &#123;cipher&#125;FKSAJDFGYOS8F7GLHAKERGFHLSAJ</span><br></pre></td></tr></table></figure>

<p>However, if the configuration file you use is in yml format, you need to use single quotes to enclose the encrypted content, as follows:</p>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">spring:</span></span><br><span class="line">     <span class="attr">datasource:</span></span><br><span class="line">         <span class="attr">username:</span> <span class="string">dbuser</span></span><br><span class="line">         <span class="attr">password:</span> <span class="string">'&#123;cipher&#125;FKSAJDFGYOS8F7GLHAKERGFHLSAJ'</span></span><br></pre></td></tr></table></figure>

<h4 id="Asymmetric-encryption"><a href="#Asymmetric-encryption" class="headerlink" title="Asymmetric encryption"></a>Asymmetric encryption</h4><p>Asymmetric encryption is a bit more complicated than symmetric encryption. First, we need to use Java’s <code>keytool</code> to generate a key pair, and then create a <code>Key Store</code> and copy it to the server directory.</p>
<ol>
<li><p>Use <code>keytool</code> to generate <code>Key Store</code>, the command is as follows:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">$keytool -genkeypair -alias tsfjckey -keyalg RSA \</span><br><span class="line">   -dname &quot;CN = Mall Web, OU = TwoStepsFromJava, O = Organization, L = city, S = province, C = china&quot; \</span><br><span class="line">   -keypass javatwostepsfrom -keystore server.jks -storepass twostepsfromjava</span><br></pre></td></tr></table></figure>
</li>
<li><p>Copy the generated <code>server.jks</code> to the resources directory of the project <code>config-server</code>.</p>
</li>
<li><p>Modify the configuration file:</p>
</li>
</ol>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">encrypt.key-store.location = server.jks</span><br><span class="line">encrypt.key-store.alias = tsfjckey</span><br><span class="line">encrypt.key-store.password = pwd</span><br><span class="line">encrypt.key-store.secret = pwd</span><br></pre></td></tr></table></figure>

<p>Asymmetric encryption is also more complicated to configure than symmetric encryption, but its security is also much higher.</p>
<h4 id="Use-multiple-encryption-keys"><a href="#Use-multiple-encryption-keys" class="headerlink" title="Use multiple encryption keys"></a>Use multiple encryption keys</h4><p>Maybe we need to use different encryption keys for different sensitive information. For this, our configuration file only needs to be written as follows:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">foo.bar = (cipher) &#123;key: testkey&#125; ...</span><br></pre></td></tr></table></figure>

<p>When <code>config-server</code> decrypts, it will try to obtain testkey from the configuration file as the key.</p>
<h2 id="High-availability-configuration"><a href="#High-availability-configuration" class="headerlink" title="High availability configuration"></a>High availability configuration</h2><h3 id="Integrate-Eureka"><a href="#Integrate-Eureka" class="headerlink" title="Integrate Eureka"></a>Integrate Eureka</h3><p>We used the specific address when configuring <code>config.uri</code> in <code>config-server</code>, so can I use <code>Eureka</code>? The answer is yes, we can use <code>config-server</code> as a basic unit of services just like other microservices. We just need to make the following modifications.</p>
<h4 id="Config-Server-1"><a href="#Config-Server-1" class="headerlink" title="Config-Server"></a>Config-Server</h4><p>Add following dependency to pom.xml</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.cloud<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-cloud-starter-netflix-eureka-client<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>Configure the name of our service in the configuration file and the address of the Eureka server:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">spring.application.name=config-server</span><br><span class="line"></span><br><span class="line">eureka.client.service-url.defaultZone=http://localhost:8761/eureka</span><br></pre></td></tr></table></figure>

<p>Added <code>@EnableDiscoveryClient</code> annotation to main class.</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@SpringBootApplication</span></span><br><span class="line"><span class="meta">@EnableConfigServer</span></span><br><span class="line"><span class="meta">@EnableDiscoveryClient</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ConfigServerApplication</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        SpringApplication.run(ConfigServerApplication<span class="class">.<span class="keyword">class</span>, <span class="title">args</span>)</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>If we start <code>config-server</code>, we will see the corresponding service registration on the <code>Eureka</code> server.</p>
<h4 id="Config-Client"><a href="#Config-Client" class="headerlink" title="Config-Client"></a>Config-Client</h4><p>Add following dependency to pom.xml</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.cloud<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-cloud-starter-netflix-eureka-client<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>Modify <code>bootstrap.properties</code>:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">server.port=8080</span><br><span class="line"></span><br><span class="line">spring.application.name=sample-service</span><br><span class="line">spring.cloud.config.profile=dev</span><br><span class="line"></span><br><span class="line">eureka.client.service-url.defaultZone=http://localhost:8761/eureka</span><br><span class="line"></span><br><span class="line">spring.cloud.config.discovery.enabled=true</span><br><span class="line">spring.cloud.config.discovery.service-id=config-server</span><br></pre></td></tr></table></figure>

<p>The most important thing here is to add: <code>spring.cloud.config.discovery.enabled = true</code> in the configuration, and change the <code>spring.cloud.config.uri</code> configured to s<code>pring.cloud.config.discovery.service-id</code>.</p>
<p>Modify main class.</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@EnableDiscoveryClient</span></span><br><span class="line"><span class="meta">@SpringBootApplication</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ConfigClientApplication</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        SpringApplication.run(ConfigClientApplication<span class="class">.<span class="keyword">class</span>, <span class="title">args</span>)</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="Fast-failure-and-response"><a href="#Fast-failure-and-response" class="headerlink" title="Fast failure and response"></a>Fast failure and response</h3><h4 id="Start-Config-Server-to-start-loading"><a href="#Start-Config-Server-to-start-loading" class="headerlink" title="Start Config-Server to start loading"></a>Start Config-Server to start loading</h4><p>By default, the server will load from the configured Git repository only when the client requests it. We can set <code>clone-on-start</code> to make the server load at startup.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">spring.cloud.config.server.git.uri = https://git/common/config-repo.git</span><br><span class="line"></span><br><span class="line">spring.cloud.config.server.git.repos.team-a.pattern = team-a- *</span><br><span class="line">spring.cloud.config.server.git.repos.team-a.clone-on-start = true</span><br><span class="line">spring.cloud.config.server.git.repos.team-a.uri = http://git/team-a/config-repo.git</span><br><span class="line"></span><br><span class="line">spring.cloud.config.server.git.repos.team-b.pattern = team-b- *</span><br><span class="line">spring.cloud.config.server.git.repos.team-b.clone-on-start = false</span><br><span class="line">spring.cloud.config.server.git.repos.team-b.uri = http://git/team-b/config-repo.git</span><br><span class="line"></span><br><span class="line">spring.cloud.config.server.git.repos.team-c.pattern = team-c- *</span><br><span class="line">spring.cloud.config.server.git.repos.team-c.uri = http://git/team-a/config-repo.git</span><br></pre></td></tr></table></figure>

<p>The above configuration, for <code>team-a</code>, will load the corresponding configuration when <code>config-server</code> starts, but not for others. Of course, we can do global configuration by setting the value of <code>spring.cloud.config.server.git.clone-on-start</code>.</p>
<h4 id="Enable-Config-Client-Fast-failure"><a href="#Enable-Config-Client-Fast-failure" class="headerlink" title="Enable Config-Client Fast failure"></a>Enable Config-Client Fast failure</h4><p>In some cases, we want to fast failure a service when it is unable to connect to the server. We can achieve it by set:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">spring.cloud.config.fail-fast = true</span><br></pre></td></tr></table></figure>

<h4 id="Set-Config-Client-to-retry"><a href="#Set-Config-Client-to-retry" class="headerlink" title="Set Config-Client to retry"></a>Set Config-Client to retry</h4><p>If <code>config-server</code> happens to be unavailable at startup and you want to retry later, then we start to enable <code>config-client</code>s retry mechanism. First, we need to configure:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">spring.cloud.config.fail-fast = true</span><br></pre></td></tr></table></figure>

<p>Then we need to add to our dependencies:</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.retry<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-retry<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-aop<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>In this way, we can enable the retry mechanism for the <code>config-client</code>. When the connection to the <code>config-server</code> fails, the <code>config-client</code> will continue to try to connect to the <code>config-server</code>. By default, it will try to connect 6 times. The time interval is initially <code>1000 milliseconds</code>. Each connection attempt will increase the interval between connection attempts by a factor of <code>1.1</code>. An error will only be returned if the connection cannot be connected to <code>config-server</code> at the end. We can do this by overriding <code>spring.cloud.config.retry.*</code> In the configuration file.</p>
<blockquote>
<p>If you want full control over the retry mechanism, you can implement the class: <code>RetryOperationsInterceptor</code> and set the bean id to: <code>configServerRetryInterceptor</code>.</p>
</blockquote>
<h3 id="Dynamic-refresh-configuration"><a href="#Dynamic-refresh-configuration" class="headerlink" title="Dynamic refresh configuration"></a>Dynamic refresh configuration</h3><p>THe <code>config-client</code> provides a refresh endpoint to refresh the configuration file. To use this feature, we need to add the following dependencies to the pom.xml file of <code>config-client</code>:</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span> spring-boot-starter-actuator<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>In this way, when the configuration file is modified and submitted to the Git repository, you can use: <code>http://localhost: 8080/refresh</code> to refresh the local configuration data.</p>
<blockquote>
<p>However, the best way is to integrate with <code>Spring Cloud Bus</code> so that the automatic distribution of the configuration can be achieved instead of manually refreshing the configuration.</p>
</blockquote>
<p>Check out the source code here: <a href="https://github.com/nicklee1006/SpringCloudDemo/tree/master/config" target="_blank" rel="noopener">Config demo</a></p>

                </article>
                <ul class="tags-postTags">
                    
                </ul>
            </div>
        </div>
    </div>

    
    <nav id="gobottom" class="pagination">
        
        <a class="prev-post" title="Leetcode 86. Partition List" href="/Leetcode-86-Partition-List/">
            ← Leetcode 86. Partition List
        </a>
        
        <span class="prev-next-post">·</span>
        
        <a class="next-post" title="Java TreeMap" href="/Java-TreeMap/">
            Java TreeMap →
        </a>
        
    </nav>

    
    <div class="inner">
        <div id="comment"></div>
    </div>
    
</div>

<div class="toc-bar">
    <div class="toc-btn-bar">
        <a href="#site-main" class="toc-btn">
            <svg viewbox="0 0 1024 1024" xmlns="http://www.w3.org/2000/svg"><path d="M793.024 710.272a32 32 0 1 0 45.952-44.544l-310.304-320a32 32 0 0 0-46.4 0.48l-297.696 320a32 32 0 0 0 46.848 43.584l274.752-295.328 286.848 295.808z"/></svg>
        </a>
        <div class="toc-btn toc-switch">
            <svg class="toc-open" viewbox="0 0 1024 1024" xmlns="http://www.w3.org/2000/svg"><path d="M779.776 480h-387.2a32 32 0 0 0 0 64h387.2a32 32 0 0 0 0-64M779.776 672h-387.2a32 32 0 0 0 0 64h387.2a32 32 0 0 0 0-64M256 288a32 32 0 1 0 0 64 32 32 0 0 0 0-64M392.576 352h387.2a32 32 0 0 0 0-64h-387.2a32 32 0 0 0 0 64M256 480a32 32 0 1 0 0 64 32 32 0 0 0 0-64M256 672a32 32 0 1 0 0 64 32 32 0 0 0 0-64"/></svg>
            <svg class="toc-close hide" viewbox="0 0 1024 1024" xmlns="http://www.w3.org/2000/svg"><path d="M512 960c-247.039484 0-448-200.960516-448-448S264.960516 64 512 64 960 264.960516 960 512 759.039484 960 512 960zM512 128.287273c-211.584464 0-383.712727 172.128262-383.712727 383.712727 0 211.551781 172.128262 383.712727 383.712727 383.712727 211.551781 0 383.712727-172.159226 383.712727-383.712727C895.712727 300.415536 723.551781 128.287273 512 128.287273z"/><path d="M557.05545 513.376159l138.367639-136.864185c12.576374-12.416396 12.672705-32.671738 0.25631-45.248112s-32.704421-12.672705-45.248112-0.25631l-138.560301 137.024163-136.447897-136.864185c-12.512727-12.512727-32.735385-12.576374-45.248112-0.063647-12.512727 12.480043-12.54369 32.735385-0.063647 45.248112l136.255235 136.671523-137.376804 135.904314c-12.576374 12.447359-12.672705 32.671738-0.25631 45.248112 6.271845 6.335493 14.496116 9.504099 22.751351 9.504099 8.12794 0 16.25588-3.103239 22.496761-9.247789l137.567746-136.064292 138.687596 139.136568c6.240882 6.271845 14.432469 9.407768 22.65674 9.407768 8.191587 0 16.352211-3.135923 22.591372-9.34412 12.512727-12.480043 12.54369-32.704421 0.063647-45.248112L557.05545 513.376159z"/></svg>
        </div>
        <a href="#gobottom" class="toc-btn">
            <svg viewbox="0 0 1024 1024" xmlns="http://www.w3.org/2000/svg"><path d="M231.424 346.208a32 32 0 0 0-46.848 43.584l297.696 320a32 32 0 0 0 46.4 0.48l310.304-320a32 32 0 1 0-45.952-44.544l-286.848 295.808-274.752-295.36z"/></svg>
        </a>
    </div>
    <div class="toc-main">
        <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#Example-project"><span class="toc-text">Example project</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Config-Server"><span class="toc-text">Config-Server</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1-Pom-xml"><span class="toc-text">1. Pom.xml</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-Main-application"><span class="toc-text">2. Main application</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-application-properties"><span class="toc-text">3. application.properties</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#4-Sample-config-file"><span class="toc-text">4. Sample config file</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#5-Test"><span class="toc-text">5. Test</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#config-server-default-configuration"><span class="toc-text">config-server default configuration</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#config-client"><span class="toc-text">config-client</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1-pom-xml"><span class="toc-text">1. pom.xml</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-Main-application-1"><span class="toc-text">2. Main application</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-Controller"><span class="toc-text">3. Controller</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#4-bootstrap-properties"><span class="toc-text">4. bootstrap.properties</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#5-Test-1"><span class="toc-text">5. Test</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Spring-project-configuration-load-order"><span class="toc-text">Spring project configuration load order</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Detailed-configuration-rules"><span class="toc-text">Detailed configuration rules</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Git-repository-config"><span class="toc-text">Git repository config</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1-Using-placeholders"><span class="toc-text">1. Using placeholders</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-Use-pattern-matching"><span class="toc-text">2. Use pattern matching</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-Search-directory"><span class="toc-text">3. Search directory</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#4-SSH-configuration"><span class="toc-text">4. SSH configuration</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#5-Proxy"><span class="toc-text">5. Proxy</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#6-Local-cache"><span class="toc-text">6. Local cache</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#SVN-configuration"><span class="toc-text">SVN configuration</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#pom-xml"><span class="toc-text">pom.xml</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#appliaction-properties"><span class="toc-text">appliaction.properties</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#File-system"><span class="toc-text">File system</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Security"><span class="toc-text">Security</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#config-server-access-security"><span class="toc-text">config-server access security</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Encryption-and-decryption"><span class="toc-text">Encryption and decryption</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#Install-JCE-Java-Cryptography-Extension"><span class="toc-text">Install JCE (Java Cryptography Extension)</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Encryption-and-decryption-endpoint"><span class="toc-text">Encryption and decryption endpoint</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Symmetric-encryption"><span class="toc-text">Symmetric encryption</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Asymmetric-encryption"><span class="toc-text">Asymmetric encryption</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Use-multiple-encryption-keys"><span class="toc-text">Use multiple encryption keys</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#High-availability-configuration"><span class="toc-text">High availability configuration</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Integrate-Eureka"><span class="toc-text">Integrate Eureka</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#Config-Server-1"><span class="toc-text">Config-Server</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Config-Client"><span class="toc-text">Config-Client</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Fast-failure-and-response"><span class="toc-text">Fast failure and response</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#Start-Config-Server-to-start-loading"><span class="toc-text">Start Config-Server to start loading</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Enable-Config-Client-Fast-failure"><span class="toc-text">Enable Config-Client Fast failure</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Set-Config-Client-to-retry"><span class="toc-text">Set Config-Client to retry</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Dynamic-refresh-configuration"><span class="toc-text">Dynamic refresh configuration</span></a></li></ol></li></ol>
    </div>
</div>



<!-- Root element of PhotoSwipe. Must have class pswp. -->
<div class="pswp" tabindex="-1" role="dialog" aria-hidden="true">

    <!-- Background of PhotoSwipe. 
         It's a separate element as animating opacity is faster than rgba(). -->
    <div class="pswp__bg"></div>

    <!-- Slides wrapper with overflow:hidden. -->
    <div class="pswp__scroll-wrap">

        <!-- Container that holds slides. 
            PhotoSwipe keeps only 3 of them in the DOM to save memory.
            Don't modify these 3 pswp__item elements, data is added later on. -->
        <div class="pswp__container">
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
        </div>

        <!-- Default (PhotoSwipeUI_Default) interface on top of sliding area. Can be changed. -->
        <div class="pswp__ui pswp__ui--hidden">

            <div class="pswp__top-bar">

                <!--  Controls are self-explanatory. Order can be changed. -->

                <div class="pswp__counter"></div>

                <button class="pswp__button pswp__button--close" title="Close (Esc)"></button>

                <button class="pswp__button pswp__button--share" title="Share"></button>

                <button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>

                <button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button>

                <!-- Preloader demo https://codepen.io/dimsemenov/pen/yyBWoR -->
                <!-- element will get class pswp__preloader--active when preloader is running -->
                <div class="pswp__preloader">
                    <div class="pswp__preloader__icn">
                      <div class="pswp__preloader__cut">
                        <div class="pswp__preloader__donut"></div>
                      </div>
                    </div>
                </div>
            </div>

            <div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap">
                <div class="pswp__share-tooltip"></div> 
            </div>

            <button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
            </button>

            <button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)">
            </button>

            <div class="pswp__caption">
                <div class="pswp__caption__center"></div>
            </div>

        </div>

    </div>

</div>




	</div>
	


<aside class="read-next outer">
    <div class="inner">
        <div class="read-next-feed">
            
            

<article class="read-next-card" style="background-image: url(https://i.loli.net/2017/11/26/5a19c56faa29f.jpg)">
  <header class="read-next-card-header">
    <small class="read-next-card-header-sitetitle">&mdash; Nick Li &mdash;</small>
    <h3 class="read-next-card-header-title">Recent Posts</h3>
  </header>
  <div class="read-next-divider">
    <svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24">
      <path d="M13 14.5s2 3 5 3 5.5-2.463 5.5-5.5S21 6.5 18 6.5c-5 0-7 11-12 11C2.962 17.5.5 15.037.5 12S3 6.5 6 6.5s4.5 3.5 4.5 3.5"/>
    </svg>
  </div>
  <div class="read-next-card-content">
    <ul>
      
      
      
      <li>
        <a href="/Java-Multithreading-2-Synchronized-Keyword/">Java Multithreading 2: Synchronized Keyword</a>
      </li>
      
      
      
      <li>
        <a href="/Java-Multithreading-1-Basic-Concepts/">Java Multithreading 1: Basic Concepts</a>
      </li>
      
      
      
      <li>
        <a href="/Leetcode-142-Linked-List-Cycle-II/">Leetcode 142. Linked List Cycle II</a>
      </li>
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
    </ul>
  </div>
  <footer class="read-next-card-footer">
    <a href="/archives">  MORE  → </a>
  </footer>
</article>

            
            
            

<article class="read-next-card" style="background-image: url(https://i.loli.net/2017/11/26/5a19c56faa29f.jpg)">
    <header class="read-next-card-header tagcloud-card">
        <h3 class="read-next-card-header-title">Categories</h3>
    </header>
    <div class="read-next-card-content">
        <ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/Data-Structure-and-Algorithms/">Data Structure and Algorithms</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Java/">Java</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Spring-Cloud/">Spring Cloud</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/how-to-guide/">how-to-guide</a></li></ul>
    </div>
</article>


            
            
            

<article class="read-next-card" style="background-image: url(https://i.loli.net/2017/11/26/5a19c56faa29f.jpg)">
	<header class="read-next-card-header tagcloud-card">
		<h3 class="read-next-card-header-title">Tag Cloud</h3>
	</header>
	<div class="read-next-card-content-ext">
		<a href="/tags/Cron-Expression/" style="font-size: 14px;">Cron Expression</a> <a href="/tags/Intellij/" style="font-size: 14px;">Intellij</a> <a href="/tags/Jackson/" style="font-size: 14px;">Jackson</a> <a href="/tags/Java-8-New-Features/" style="font-size: 15.11px;">Java 8 New Features</a> <a href="/tags/Java-Collections/" style="font-size: 17.33px;">Java Collections</a> <a href="/tags/Leetcode-Array/" style="font-size: 24px;">Leetcode - Array</a> <a href="/tags/Leetcode-Backtracking/" style="font-size: 22.89px;">Leetcode - Backtracking</a> <a href="/tags/Leetcode-Binary-Search/" style="font-size: 17.33px;">Leetcode - Binary Search</a> <a href="/tags/Leetcode-Bit-Manipulation/" style="font-size: 14px;">Leetcode - Bit Manipulation</a> <a href="/tags/Leetcode-Breadth-First-Search/" style="font-size: 14px;">Leetcode - Breadth First Search</a> <a href="/tags/Leetcode-Depth-First-Search/" style="font-size: 19.56px;">Leetcode - Depth First Search</a> <a href="/tags/Leetcode-Divde-and-Conquer/" style="font-size: 14px;">Leetcode - Divde and Conquer</a> <a href="/tags/Leetcode-Dynamic-Programming/" style="font-size: 21.78px;">Leetcode - Dynamic Programming</a> <a href="/tags/Leetcode-Greedy/" style="font-size: 16.22px;">Leetcode - Greedy</a> <a href="/tags/Leetcode-Hash-Table/" style="font-size: 17.33px;">Leetcode - Hash Table</a> <a href="/tags/Leetcode-Linked-List/" style="font-size: 18.44px;">Leetcode - Linked List</a> <a href="/tags/Leetcode-Math/" style="font-size: 14px;">Leetcode - Math</a> <a href="/tags/Leetcode-Sliding-Window/" style="font-size: 14px;">Leetcode - Sliding Window</a> <a href="/tags/Leetcode-Sort/" style="font-size: 15.11px;">Leetcode - Sort</a> <a href="/tags/Leetcode-Stack/" style="font-size: 14px;">Leetcode - Stack</a> <a href="/tags/Leetcode-String/" style="font-size: 19.56px;">Leetcode - String</a> <a href="/tags/Leetcode-Tree/" style="font-size: 20.67px;">Leetcode - Tree</a> <a href="/tags/Leetcode-Two-Pointers/" style="font-size: 21.78px;">Leetcode - Two Pointers</a> <a href="/tags/Leetcode-Union-Find/" style="font-size: 14px;">Leetcode - Union Find</a> <a href="/tags/Multithreading/" style="font-size: 15.11px;">Multithreading</a> <a href="/tags/Stream-API/" style="font-size: 15.11px;">Stream API</a> <a href="/tags/hexo/" style="font-size: 15.11px;">hexo</a>
	</div>
</article>

            
        </div>
    </div>
</aside>

	




<div id="search" class="search-overlay">
    <div class="search-form">
        
        <input id="local-search-input" class="search-input" type="text" name="search" placeholder="Search ...">
        <a class="search-overlay-close" href="#"></a>
    </div>
    <div id="local-search-result"></div>
</div>

<footer class="site-footer outer">
	<div class="site-footer-content inner">
		<div class="copyright">
			<a href="/" title="Nick Li">Nick Li &copy; 2020</a>
			
				
			        <span hidden="true" id="/Spring-Cloud-10-Unified-Configuration-Center/" class="leancloud-visitors" data-flag-title="Spring Cloud 10: Unified Configuration Center">
			            <span>阅读量 </span>
			            <span class="leancloud-visitors-count">0</span>
			        </span>
	    		
    		
		</div>
		<nav class="site-footer-nav">
			
			<a href="https://hexo.io/" title="Hexo" target="_blank" rel="noopener">Hexo</a>
			<a href="https://github.com/xzhih/hexo-theme-casper" title="Casper" target="_blank" rel="noopener">Casper</a>
		</nav>
	</div>
</footer>
	


<script>
    if(window.navigator && navigator.serviceWorker) {
        navigator.serviceWorker.getRegistrations().then(function(registrations) {
            for(let registration of registrations) {
                registration.unregister()
            }
        })
    }
</script>


<script id="scriptLoad" src="/js/allinone.min.js" async></script>


<script>
    document.getElementById('scriptLoad').addEventListener('load', function () {
        
        
            var bLazy = new Blazy();
        

        
        

        
        
        
            searchFunc("/");
        
        
    })
</script>



<link rel="stylesheet" href="/photoswipe/photoswipe.css">
<link rel="stylesheet" href="/photoswipe/default-skin/default-skin.css">
<script src="/photoswipe/photoswipe.min.js"></script>
<script src="/photoswipe/photoswipe-ui-default.min.js"></script>




<script id="valineScript" src="//unpkg.com/valine/dist/Valine.min.js" async></script>
<script>
    document.getElementById('valineScript').addEventListener("load", function() {
        new Valine({
            el: '#comment' ,
            verify: false,
            notify: false,
            appId: '3TACGUnsSRuWgqCn3pRpLVwQ-MdYXbMMI',
            appKey: 'JTo5iyjOyGTEXzAwjaTNqcY0',
            placeholder: 'Please leave a comment',
            pageSize: 10,
            avatar: 'mm',
            visitor: true,
            lang: 'en'
        })
    });
</script>





</body>
</html>
